name: Build

on:
  push:
    branches: [ main ]
  pull_request:
    types: [ closed ]
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
#  build:
#    runs-on: ubuntu-latest
#    steps:
#      - uses: actions/checkout@v3
#
#      - uses: actions-ecosystem/action-get-latest-tag@v1
#        id: get-latest-tag
#
#      - uses: actions-ecosystem/action-bump-semver@v1
#        id: bump-semver
#        with:
#          current_version: ${{ steps.get-latest-tag.outputs.tag }}
#          level: minor
#
#      - uses: actions-ecosystem/action-push-tag@v1
#        if: ${{ steps.bump-semver.outputs.new_version != null }}
#        with:
#          tag: ${{ steps.bump-semver.outputs.new_version }}
#          message: "${{ steps.bump-semver.outputs.new_version }}: PR #${{ steps.get-merged-pull-request.outputs.number }} ${{ steps.get-merged-pull-request.outputs.title }}"
#
#
#      - name: Login to DockerHub
#        uses: docker/login-action@v2
#        with:
#          username: ${{ secrets.DOCKERHUB_USERNAME }}
#          password: ${{ secrets.DOCKERHUB_TOKEN }}
#
#      - name: Build and push
#        uses: docker/build-push-action@v3
#        with:
#          context: .
#          push: true
#          tags: eostribe/fio_wrapping:${{ steps.bump-semver.outputs.new_version }}
  deployment:
    runs-on: ubuntu-latest
    environment: dev
    steps:
      - name: deploy
        shell: bash
        env:
          CA_PEM: ${{ secrets.CA_PEM }}
          CERT_PEM: ${{ secrets.CERT_PEM }}
          KEY_PEM: ${{ secrets.KEY_PEM }}
        run: |
          echo -e "$CA_PEM" > ~/.docker/ca.pem
          echo -e "$CERT_PEM" > ~/.docker/cert.pem
          echo -e "$KEY_PEM" > ~/.docker/key.pem
          docker --tlsverify -H=api-de.eostribe.io:2376 ps -a
       

          
          
